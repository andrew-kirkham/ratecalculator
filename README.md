[![Build Status](https://travis-ci.org/andrew-kirkham/ratecalculator.svg?branch=master)](https://travis-ci.org/andrew-kirkham/ratecalculator)

# RateCalculator

## What is it
This project calculates parking rates for a given time interval.


## Endpoints
* `<base_url>/` is the Swagger documentation for `<base_url>/api`
* `<base_url>/api` is the endpoint for all actions 
    * `<base_url>/api/metrics` provides statistics and healthchecks about the application

## Documentation
Full documentation can be found by visiting `<base_url>` and viewing the swagger documentation.
This documentation outlines the expected request response types.
Both JSON and XML are supported.

## Building

### Local builds
Locally this project can be built using gradle. 

* `gradle appRun` will start a hot-swap instance of jetty
* `gradle war` will build the war file used for deployment
* `gradle test` will execute the tests

### CI Builds
This project is integrated with Travis CI for builds. 
Travis will automagically run the tests on each commit and display the status at the top of this readme.

## Deployment
### AWS CodeDeploy
Provided are necessary scripts for an AWS CodeDeploy deployment.

An example setup for AWS CodeDeploy. Note all steps are via AWS console
* Create a CodeDeploy IAM group (if not already created)
* Setup an AWS CodePipeline that is tied to this (or your) repo
* Setup an ASG (recommended min 1, max 3)
* Setup AWS CodeDeploy as a stage in the CodePipeline
    * tie in the ASG and IAM group
* Commit or manually kick of CodePipeline
* Enjoy your fresh new EC2 instance!
* Optional - register Route 53 with your load balancer

### Spinnaker/Foremast
Provided in the runway folder are configuration files for a Spinnaker deployment. 
If Foremast is used, this files can be loaded to automate the spinnaker pipeline directly.

## Future Work
Items to add in the future:
* gRPC
    * a sample proto file is given
    * requests would use the same ApiHandler to calculate rates
    * protobuf files would be autogenerated by gradle
* validate configuations on startup
* consider modifying normal 200 rate response to a json structure to be uniform